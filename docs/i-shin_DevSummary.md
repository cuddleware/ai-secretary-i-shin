# i-shin 開発チャット要点まとめ（RAGナレッジ向け）

## プロジェクト概要

* **クライアント**：i-shin
* **目的**：Excel＋VBAで "コストの見える化" を実現する業務ツールの開発
* **主要機能**：生産日報入力、原価・売上・利益のビュー表示、グラフ出力、固定費／人件費原価の集計
* **開発環境**：Excel VBA、ActiveX コントロール、一部 Scripting.Dictionary を活用

---

## シート構成と機能

* **T\_生産実績**：日報の記録テーブル（加工単位）
* **M\_作業員**：従業員情報（時給・月給含む）
* **M\_品番**：製品情報（単価・客先名）
* **M\_固定費**：固定費情報（費目・期間・金額・単位）
* **生産日報\_入力テンプレート**：作業日報の入力UI
* **原価ビュー**：人件費原価の集計表示
* **売上ビュー**：売上金額の集計表示
* **利益ビュー**：利益の計算とグラフ表示（粒度：日別／月別／年別）

---

## ビュー機能（共通構成）

* 各ビューには以下の UI を配置：

  * 集計単位選択（cmbUnit）
  * 期間選択（開始・終了日または年月・年）
  * 一覧出力（B13～）
  * サマリー表示領域（G4～I5）
  * グラフ表示（I7以降、日別・月別・年別対応）

---

## 利益ビューの構成と処理

* **関数群**：

  * `OutputProfitList_ByDay`：日別の一覧表示（利益・原価内訳）
  * `OutputProfitViewDaily`：日別のグラフ表示
  * `OutputProfitViewMonthly`／`Yearly`：粒度に応じたグラフ生成
  * `RunProfitViewWorkflow`：一覧とグラフのコントロール関数
* **集計関数**：

  * `GetSalesRecordsByDay/Month/Year`
  * `GetLaborCostPerDay/Month/Year`
  * `GetFixedCostPerDay/Month/Year`

---

## 集計・表示の方針

* **利益**＝売上金額－（人件費原価＋固定費原価）
* **固定費表示順**：社員給与→油代→修理費（全粒度共通）
* **固定費の単位**：「月額」「一括」「日額」に対応
* **売上／原価／利益を一覧＆グラフで可視化し、粒度による切替に対応**
* **縦軸スケーリング**：オートスケール機能実装済み（GetNiceUnit）

---

## ユースケース

1. **今日の売上／利益を確認したい**：日別表示で対応
2. **今月のコスト構成を把握したい**：月別表示で対応
3. **年次トレンド分析を行いたい**：年別表示＋グラフで対応

---

## 今後の展開

* **RAG＋チャットボット構想**：本ドキュメントを含む過去の会話・仕様・ユースケースをベースにナレッジ化
* **Phase1～3 完了後に AI 秘書としての展開を検証**
* **今後の改善ポイント**：コスト項目の自動補完、サマリーカードの拡張、UI精度向上
